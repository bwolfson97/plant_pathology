---

title: Create Cross Validation Folds


keywords: fastai
sidebar: home_sidebar

summary: "Script to create folds for 5-fold cross validation."
description: "Script to create folds for 5-fold cross validation."
nb_path: "nbks/06_create_folds.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbks/06_create_folds.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since we have a small dataset, we will do <strong>5-fold cross-validation</strong> rather than the normal <strong>hold-out set</strong> based validation. This will provide us a more accurate idea of our model's generalization ability since it will be less influenced by the variance of any single split. Additionally, since the dataset is small, it won't be too compute-heavy to do this form of validation.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="create_folds" class="doc_header"><code>create_folds</code><a href="https://github.com/bwolfson97/plant_pathology/tree/master/plant_pathology/create_folds.py#L13" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>create_folds</code>(<strong><code>path</code></strong>:"Path to train CSV", <strong><code>print_stats</code></strong>:"Print class distributions across folds?", <strong><code>save</code></strong>:"Save CSV with added folds"=<em><code>True</code></em>)</p>
</blockquote>
<p>Saves train CSV at <code>path</code> with 5-fold CV splits added.</p>
<p>Optionally, print class distribution across folds.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">create_folds</span><span class="p">(</span><span class="n">DATA_PATH</span><span class="o">/</span><span class="s2">&quot;train.csv&quot;</span><span class="p">,</span> <span class="n">print_stats</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Proportion of each class out of total examples in each fold:
       healthy multiple_diseases      rust      scab
          mean              mean      mean      mean
fold                                                
0.0   0.282192          0.052055  0.342466  0.323288
1.0   0.282967          0.049451  0.343407  0.324176
2.0   0.285714          0.049451  0.340659  0.324176
3.0   0.282967          0.049451  0.340659  0.326923
4.0   0.282967          0.049451  0.340659  0.326923
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>image_id</th>
      <th>healthy</th>
      <th>multiple_diseases</th>
      <th>rust</th>
      <th>scab</th>
      <th>fold</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Train_1511</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Train_1799</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Train_135</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Train_408</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Train_1693</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

